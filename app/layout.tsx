import "./globals.css";
import type { Metadata } from "next";

import Sidebar from "@/components/Layout/SidebarMenu";
import prisma from "@/lib/db"; // Import Prisma

export const metadata: Metadata = {
  title: "Encyclochain",
  description: "Generated by create next app",
};

// Fonction pour récupérer les sections via Prisma
async function getSectionTypes() {
  try {
    const sectionTypes = await prisma.sectionType.findMany({
      select: {
        id: true,
        title: true,
      },
    });
    return sectionTypes;
  } catch (error) {
    console.error("Error fetching section types:", error);
    return [];
  }
}

// Marque RootLayout comme async
export default async function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const sectionTypes = await getSectionTypes(); // Utilisation de `await` ici

  return (
    <html lang="fr">
      <body className="h-screen flex overflow-hidden">
        {/* Sidebar always visible */}
        <Sidebar sectionTypes={sectionTypes} />
        <div className="flex-1 flex flex-col overflow-y-auto">
          {/* Render child components */}
          {children}
   
        </div>
      </body>
    </html>
  );
}
